/*!
* Bootstrap-Extensions.js by Ivan Kerin
* Copyright 2013 OpenBuildings, Inc.
* http://www.apache.org/licenses/LICENSE-2.0.txt
*/
!function(e){"use strict";var t=function(t,n){var r=e(t);r.on("dragstart",function(t){t.originalEvent.dataTransfer.setData("text/plain",r.text());e(t.currentTarget).data("current",t.target).data("x",t.originalEvent.clientX).data("y",t.originalEvent.clientY)});r.on("dragover",function(e){e.preventDefault()});r.on("drop",function(t){var n=e(e(t.currentTarget).data("current")),r=n.position().left+t.originalEvent.clientX-e(t.currentTarget).data("x"),i=n.position().top+t.originalEvent.clientY-e(t.currentTarget).data("y");n.css({left:r/e(t.currentTarget).width()*100+"%",top:i/e(t.currentTarget).height()*100+"%"});n.find('[data-draggable="left"]').val(r/e(t.currentTarget).width()*100);n.find('[data-draggable="top"]').val(i/e(t.currentTarget).height()*100)})};t.prototype={constructor:t};var n=e.fn.draggable;e.fn.draggable=function(n){return this.each(function(){var r=e(this),i=r.data("draggable"),s=typeof n==="object"&&n;if(!i){r.data("draggable",i=new t(this,s))}if(typeof n==="string"){i[n]()}})};e.fn.draggable.Constructor=t;e.fn.draggable.noConflict=function(){e.fn.draggable=n;return this};e(function(){e(document).on("mouseover.draggable.data-api",'[data-provide="draggable"]',function(t){var n=e(this);if(n.data("draggable"))return;t.preventDefault();n.draggable(n.data())})})}(window.jQuery);!function(e){"use strict";var t=function(t,n){this.$element=e(t);this.type=this.$element.data("uploadtype")||(this.$element.find(".thumbnail").length>0?"image":"file");this.$input=this.$element.find(":file");if(this.$input.length===0)return;this.name=this.$input.attr("name")||n.name;this.$hidden=this.$element.find('input[type=hidden][name="'+this.name+'"]');if(this.$hidden.length===0){this.$hidden=e('<input type="hidden" />');this.$element.prepend(this.$hidden)}this.$preview=this.$element.find(".fileupload-preview");var r=this.$preview.css("height");if(this.$preview.css("display")!="inline"&&r!="0px"&&r!="none")this.$preview.css("line-height",r);this.original={exists:this.$element.hasClass("fileupload-exists"),preview:this.$preview.html(),hiddenVal:this.$hidden.val()};this.$remove=this.$element.find('[data-dismiss="fileupload"]');this.$element.find('[data-trigger="fileupload"]').on("click.fileupload",e.proxy(this.trigger,this));this.listen()};t.prototype={listen:function(){this.$input.on("change.fileupload",e.proxy(this.change,this));e(this.$input[0].form).on("reset.fileupload",e.proxy(this.reset,this));if(this.$remove)this.$remove.on("click.fileupload",e.proxy(this.clear,this))},change:function(e,t){if(t==="clear")return;var n=e.target.files!==undefined?e.target.files[0]:e.target.value?{name:e.target.value.replace(/^.+\\/,"")}:null;if(!n){this.clear();return}this.$hidden.val("");this.$hidden.attr("name","");this.$input.attr("name",this.name);if(this.type==="image"&&this.$preview.length>0&&(typeof n.type!=="undefined"?n.type.match("image.*"):n.name.match(/\.(gif|png|jpe?g)$/i))&&typeof FileReader!=="undefined"){var r=new FileReader;var i=this.$preview;var s=this.$element;r.onload=function(e){i.html('<img src="'+e.target.result+'" '+(i.css("max-height")!="none"?'style="max-height: '+i.css("max-height")+';"':"")+" />");s.addClass("fileupload-exists").removeClass("fileupload-new")};r.readAsDataURL(n)}else{this.$preview.text(n.name);this.$element.addClass("fileupload-exists").removeClass("fileupload-new")}},clear:function(e){this.$hidden.val("");this.$hidden.attr("name",this.name);this.$input.attr("name","");if(navigator.userAgent.match(/msie/i)){var t=this.$input.clone(true);this.$input.after(t);this.$input.remove();this.$input=t}else{this.$input.val("")}this.$preview.html("");this.$element.addClass("fileupload-new").removeClass("fileupload-exists");if(e){this.$input.trigger("change",["clear"]);e.preventDefault()}},reset:function(e){this.clear();this.$hidden.val(this.original.hiddenVal);this.$preview.html(this.original.preview);if(this.original.exists)this.$element.addClass("fileupload-exists").removeClass("fileupload-new");else this.$element.addClass("fileupload-new").removeClass("fileupload-exists")},trigger:function(e){this.$input.trigger("click");e.preventDefault()}};e.fn.fileupload=function(n){return this.each(function(){var r=e(this),i=r.data("fileupload");if(!i)r.data("fileupload",i=new t(this,n));if(typeof n=="string")i[n]()})};e.fn.fileupload.Constructor=t;e(document).on("click.fileupload.data-api",'[data-provides="fileupload"]',function(t){var n=e(this);if(n.data("fileupload"))return;n.fileupload(n.data());var r=e(t.target).closest('[data-dismiss="fileupload"],[data-trigger="fileupload"]');if(r.length>0){r.trigger("click.fileupload");t.preventDefault()}})}(window.jQuery);!function(e){"use strict";var t=function(t,n){var r=e(t);r.on("dragstart",function(t){var i=t.target;t.originalEvent.dataTransfer.setData("text/plain",r.text());e(n.dropzone).addClass("drop-target").height(e(n.dropzone).closest(".row-fluid").height()).data("href",e(i).data("href"))}).on("dragover",function(e){e.preventDefault()}).on("dragend",function(t){e(n.dropzone).removeClass("drop-target").data("href",false)});e(n.dropzone).on("dragover",function(e){e.preventDefault()}).on("drop",function(t){if(e(t.currentTarget).data("href")){window.location=e(t.currentTarget).data("href")}return false})};t.prototype={constructor:t};var n=e.fn.filters;e.fn.filters=function(n){return this.each(function(){var r=e(this),i=r.data("filters"),s=typeof n==="object"&&n;if(!i){r.data("filters",i=new t(this,s))}if(typeof n==="string"){i[n]()}})};e.fn.filters.Constructor=t;e.fn.filters.noConflict=function(){e.fn.filters=n;return this};e(function(){e(document).on("mouseover.filters.data-api",'[data-provide="filters"]',function(t){var n=e(this);if(n.data("filters"))return;t.preventDefault();n.filters(n.data())})})}(window.jQuery);!function(e){"use strict";function t(t,n){return e(t).data("sortableId")||e(t).find(n).data("sortableId")}e(function(){function t(t,n){var r=[],n=n||"item";e.each(t,function(){r.push(n+"[]="+e(this).data("sortableId"))});return r.join("&")}document.addEventListener("mousedown",function(n){if(e(n.target).closest('[data-provide="sortable"]').length){var r=e(n.target).closest('[data-provide="sortable"]');if(r.data("sortable"))return;r.sortable({handle:r.data("handle"),items:r.data("items"),placeholder:r.data("placeholder"),tolerance:r.data("tolerance"),stop:function(n,r){if(e(this).data("sortUrl")){e.ajax({url:e(this).data("sortUrl"),data:t(e(this).find("[data-sortable-id]")),type:"post",dataType:"json"})}else{e(this).children().each(function(t){e(this).find('[data-sortable="position"]').val(t)})}}})}},true)})}(window.jQuery);!function(e){"use strict";var t=function(t,n){this.$element=e(t)};t.prototype={constructor:t,reindex:function(){var t=this.$element;var n=new RegExp(t.attr("data-index").replace(/[\-\[\]\/\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace("{{index}}","(\\d+)"));t.children(".multiform").each(function(r){e(this).find("input,select,textarea").each(function(){e(this).attr("name",e(this).attr("name").replace(n,t.attr("data-index").replace("{{index}}",r)))})})},add:function(t){e('<div class="multiform fade"></div>').html(e(t).clone().html()).prependTo(this.$element).addClass("in");this.$element.multiform("reindex")}};var n=e.fn.multiform;e.fn.multiform=function(n,r){return this.each(function(){var i=e(this),s=i.data("multiform"),o=typeof n==="object"&&n;if(!s){i.data("multiform",s=new t(this,o))}if(typeof n==="string"){s[n](r)}})};e.fn.multiform.Constructor=t;e.fn.multiform.noConflict=function(){e.fn.multiform=n;return this};e(function(){e(document).on("click.multiform.data-api","[data-multiform-add]",function(t){var n=e(e(this).data("multiformAdd"));t.preventDefault();n.multiform("add",e(this).attr("href"))});e(document).on("click.multiform.data-api",'[data-dismiss="multiform"]',function(t){function i(){n.remove();r.multiform("reindex")}var n=e(this).closest(".multiform"),r=n.parent();t.preventDefault();if(e.support.transition){n.addClass("fade").removeClass("in").on(e.support.transition.end,i)}else{i()}})})}(window.jQuery);!function(e){"use strict";var t=function(t,n){var r=this.$element=e(t);this.url=n.url;this.templatestring=n.templatestring;this.count=n.count||e(n.container).children().length;this.$container=e(n.container);this.$element.typeahead({source:n.source,val:{},itemSelected:function(t){if(n.overwrite){e(n.container).empty();r.addClass("hide")}r.val("").remoteselect("add",t)}})};t.prototype={constructor:t,add:function(t){var n=this.$container;if(this.templatestring){n.append(this.templatestring.replace(/\{\{id\}\}/g,t.id).replace(/\{\{variations\}\}/g,t.variations).replace(/\{\{count\}\}/g,this.count++).replace(/\{\{model\}\}/g,t.model).replace(/\{\{name\}\}/g,t.name).replace(/\{\{price\}\}/g,t.price).replace(/\{\{url\}\}/g,t.url));e(".chzn-select").chosen()}else{e.get(this.url.replace(/\{\{id\}\}/g,t?t.id:"").replace(/\{\{count\}\}/g,this.count++).replace(/\{\{model\}\}/g,t?t.model:""),function(t){n.append(t);e(".chzn-select").chosen()})}}};var n=e.fn.remoteselect;e.fn.remoteselect=function(n,r,i){return this.each(function(){var s=e(this),o=s.data("remoteselect"),u=typeof n==="object"&&n;if(!o){s.data("remoteselect",o=new t(this,u||s.data()))}if(typeof n==="string"){o[n](r,i)}})};e.fn.remoteselect.Constructor=t;e.fn.remoteselect.noConflict=function(){e.fn.remoteselect=n;return this};e(function(){e(document).on("focus.remoteselect.data-api",'[data-provide="remoteselect"]',function(t){var n=e(this);if(n.data("remoteselect"))return;t.preventDefault();n.remoteselect(n.data())});e(document).on("click.remoteselect.data-api",'[data-dismiss="remoteselect"]',function(t){function r(){e('input[data-container="#'+n.parent().attr("id")+'"]').removeClass("hide").addClass("in");n.remove()}var n=e(this).closest(".remoteselect-item");t.preventDefault();if(e.support.transition){n.addClass("fade").on(e.support.transition.end,r)}else{r()}});e(document).on("click.remoteselect.data-api","[data-remoteselect-new]",function(t){var n=e(e(this).attr("href")).length?e(e(this).attr("href")):e(this).siblings('[data-provide="remoteselect"]');t.preventDefault();n.remoteselect("add",null,e(this).data("remoteselectNew"))})})}(window.jQuery);!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){function o(){n.removeClass("active");r.addClass("active");if(s){r.addClass("in")}else{r.removeClass("fade")}if(t.data("disable")){r.removeAttr("disabled");n.attr("disabled","disabled")}t.trigger({type:"shown",target:r,relatedTarget:n})}var t=this.element,n=e(t.data("previous")),r=e("#"+(t.data("tabPrefix")||"")+t.val()),i,s=e.support.transition&&r.hasClass("fade");if(r.hasClass("active"))return;i=e.Event("show",{target:r,relatedTarget:n});t.trigger(i);if(i.isDefaultPrevented())return;if(s){n.one(e.support.transition.end,o)}else{o()}n.removeClass("in");t.data("previous","#"+(t.data("tabPrefix")||"")+t.val())}};var n=e.fn.selecttab;e.fn.selecttab=function(n){return this.each(function(){var r=e(this),i=r.data("selecttab");if(!i)r.data("selecttab",i=new t(this));if(typeof n=="string")i[n]()})};e.fn.selecttab.Constructor=t;e.fn.selecttab.noConflict=function(){e.fn.selecttab=n;return this};e(document).on("change.selecttab.data-api",'[data-provide="selecttab"]',function(t){t.preventDefault();e(this).selecttab("show")})}(window.jQuery);!function(e){"use strict";var t={source:[],maxResults:8,minLength:1,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',display:"name",val:"id",itemSelected:function(){}},n={DOWN:40,ENTER:13||108,ESCAPE:27,TAB:9,UP:38},r=function(t,n){this.$element=e(t);this.options=e.extend(true,{},e.fn.typeahead.defaults,n);this.$menu=e(this.options.menu).appendTo("body");this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.shown=false;this.initSource();this.listen()};r.prototype={constructor:r,initSource:function(){if(this.options.source){if(typeof this.options.source==="string"){this.source=e.extend({},e.ajaxSettings,{url:this.options.source})}else if(typeof this.options.source==="object"){if(this.options.source instanceof Array){this.source=this.options.source}else{this.source=e.extend(true,{},e.ajaxSettings,this.options.source)}}}},eventSupported:function(e){var t=e in this.$element;if(!t){this.$element.setAttribute(e,"return;");t=typeof this.$element[e]==="function"}return t},lookup:function(t){var n=this,r;this.query=this.$element.val();if(!this.query||this.query.length<this.options.minLength){return this.shown?this.hide():this}if(this.source.url){if(this.xhr)this.xhr.abort();this.xhr=e.ajax(e.extend({},this.source,{data:{query:n.query},success:e.proxy(n.filter,n)}))}else{r=e.proxy(n.filter(n.source),n)}},filter:function(t){var n=this,r;r=e.grep(t,function(e){var t=n.query.toLowerCase().split(" "),r=e[n.options.display].toLowerCase();for(var i=t.length-1;i>=0;i--){if(~r.indexOf(t[i]))return true}});if(!r||!r.length){return this.shown?this.hide():this}else{r=r.slice(0,this.options.maxResults)}return this.render(this.sorter(r)).show()},sorter:function(e){var t=this,n=[],r=[],i=[],s;while(s=e.shift()){if(!s[t.options.display].toLowerCase().indexOf(this.query.toLowerCase())){n.push(s)}else if(~s[t.options.display].indexOf(this.query)){r.push(s)}else{i.push(s)}}return n.concat(r,i)},show:function(){var t=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.$menu.css({top:t.top+t.height,left:t.left});this.$menu.show();this.shown=true;return this},hide:function(){this.$menu.hide();this.shown=false;return this},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this,r,i;t=e(t).map(function(t,s){if(n.options.tmpl){t=e(n.options.tmpl(s))}else{t=e(n.options.item)}if(typeof n.options.val==="string"){t.attr("data-value",s[n.options.val])}else{t.attr("data-value",JSON.stringify(e.extend({},n.options.val,s)))}r=s[n.options.display];i=t.find("a");if(r.indexOf("typeahead-display-val")>0){i.html(r).find(".typeahead-display-val").each(function(){e(this).html(n.highlighter(e(this).html()))})}else{i.html(n.highlighter(r))}return t[0];r=t.find(".typeahead-display-val");i=t.find("a");if(r.length){r.html(n.highlighter(s[n.options.display]))}else if(i.length){i.html(n.highlighter(s[n.options.display]))}return t[0]});t.first().addClass("active");setTimeout(function(){n.$menu.html(t)},250);return this},select:function(){var e=this.$menu.find(".active");this.$element.val(e.text()).change();this.options.itemSelected(JSON.parse(e.attr("data-value")));return this.hide()},next:function(t){var n=this.$menu.find(".active").removeClass("active");var r=n.next();if(!r.length){r=e(this.$menu.find("li")[0])}r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active");var n=t.prev();if(!n.length){n=this.$menu.find("li").last()}n.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keyup",e.proxy(this.keyup,this));if(this.eventSupported("keydown")){this.$element.on("keydown",e.proxy(this.keypress,this))}else{this.$element.on("keypress",e.proxy(this.keypress,this))}this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},keyup:function(e){e.stopPropagation();e.preventDefault();switch(e.keyCode){case n.DOWN:case n.UP:break;case n.TAB:case n.ENTER:if(!this.shown)return;this.select();break;case n.ESCAPE:this.hide();break;default:this.lookup()}},keypress:function(e){e.stopPropagation();if(!this.shown)return;switch(e.keyCode){case n.TAB:case n.ESCAPE:case n.ENTER:e.preventDefault();break;case n.UP:e.preventDefault();this.prev();break;case n.DOWN:e.preventDefault();this.next();break}},blur:function(e){var t=this;e.stopPropagation();e.preventDefault();setTimeout(function(){if(!t.$menu.is(":focus")){t.hide()}},150)},click:function(e){e.stopPropagation();e.preventDefault();this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active");e(t.currentTarget).addClass("active")}};e.fn.typeahead=function(t){return this.each(function(){var n=e(this),i=n.data("typeahead"),s=typeof t==="object"&&t;if(!i){n.data("typeahead",i=new r(this,s))}if(typeof t==="string"){i[t]()}})};e.fn.typeahead.defaults=t;e.fn.typeahead.Constructor=r;e(function(){e("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;t.preventDefault();n.typeahead(n.data())})})}(window.jQuery)